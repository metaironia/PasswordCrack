# Цель задания

Взломать программу оппонента, которая проверяет вводимый пароль. Подробности см. ниже. 

# Суть программы оппонента

Программа оппонента, или Crackme, написана под систему MS-DOS на ассембелере и имеет расширение .com.

Crackme после запуска считывает вводимый пользователем пароль, после чего выдает либо отказ в доступе, если пароль неверный, либо разрешает доступ, если пароль подошел. 

# Как взламывать?

Моя задача заключалась во взломе программы оппонента при помощи двух способов: 
1. Подача таких входных данных (при вводе пароля), при которых правильный пароль не вводится, однако доступ разрешается;
2. Взлом с помощью самописной программы-патчера, изменяющей исходный код программы оппонента.  

 
***Необходимо подметить, что для взлома первым способом оппоненту необходимо заложить уязвимость в коде своей программы, иначе взлом может оказаться невозможным.***

# 1 - Взлом при вводе пароля
## Как работает программа моего оппонента
_Далее в объяснении смещение адресов будет отсчитываться от сегмента кода, а представление некоторых чисел будет в шестнадцатеричном виде (для ясности в конце таких чисел будет постфикс "h")._

Дизассемблировав и проанализировав программу оппонента, можно сделать вывод, что:
- функция, находящаяся по смещению 0114h, считывает пароль и кладет его в некоторый буфер, начинающийся со смещения 018Eh;
- в функции, находящейся по смещению 016Dh, проверяется, правильный ли пароль, и в зависимости от этого функция либо доступ предоставляет, либо запрещает.

Детальнее изучив код функции по смещению 016Dh, заметим, что в ней вызывается функция по смещению 014Ch, которая занимается ничем, кроме проверки пароля. Если введенный пароль верен, то эта функция кладет в ячейку памяти по смещению 019Eh один байт, равный 1h. Если пароль неверный, значение по смещению 019Eh остается неизменным (изначально оно равно 0h). 


После того, как функция по смещению 014Ch отработала и вернулась обратно в функцию по смещению 016Dh, происходит проверка значения байта в ячейке памяти по смещению 019Eh. Если это значение не равно 0h, доступ разрешается, в остальных случаях он запрещается.

## Как взломать программу моего оппонента

Для взлома необходимо заметить, что буфер, в который кладется введенный пользователем пароль, начинается со смещения 018Eh. Так как количество введенных символов нигде в программе не проверяется, это означает, что вводом возможно реализовать переполнение этого буфера и перезаписать значение ячейки памяти (байта) по смещению 019Eh.

Итак, чтобы переполнить этот буфер, требуется ввести не менее чем 16 символов, после чего нажать ENTER. После этого, взлом будет совершен, а доступ разрешен. ~~В СОЛЯНОГО!~~

# 2 - Взлом при помощи программы-патчера

Я написал программу-патчер, которая переписывает код проверки доступа командами NOP (no operation), вследствие чего происходит "спуск вниз" до кода, где предоставляется доступ. После работы программы-патчера программа оппонента начинает давать доступ при любом введенном пароль, а не только при верном.

## Работа патчера (кряка)

Функционал программы-патчера состоит из двух кнопок:
- кнопка "ЗВЯКНУТЬ ДЕДУ" ~~будит Деда~~ выдает случайный совет от Деда;
- кнопка "CRACK" патчит программу.

Необходимо отметить, что программа-патчер работает ~~из рук вон плохо~~ нестабильно: иногда после нажатия кнопки "CRACK" сидящий внутри _Анонимус_ не может разобраться, что надо делать, в связи с чем патч программы заканчивается провалом.

<sub>**ВНИМАНИЕ**: при использовании кряка МВД приедет упаковать вас примерно через 5-10 минут при любом исходе взлома.</sub>

# Автор
Кулагин Сергей, студент 1 курса ФРКТ МФТИ